image: saddeveloper/node-chromium:latest

variables:
    APP: "brennus-tp"

cache:
    paths:
        - node_modules

before_script:
    - npm install

stages:
    - build
    - test
    - deploy

# Build the project in production mode
build-angular:
    stage: build
    script:
        - npm run build:prod
    artifacts:
        name: $APP
        expire_in: 1 week
        paths:
            - dist/$APP/

test-angular:
    stage: test
    script:
        - npm run check:ci
    artifacts:
        name: coverage
        paths:
            - coverage/
        expire_in: 1 week


pages:
    stage: deploy
    script:
        - npm run gen:docs
    artifacts:
        paths:
            - public
        expire_in: 1 week
    only:
        - master # this job will affect only the 'master' branch
